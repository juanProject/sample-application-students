language: java

services:
  - docker

script:
  - mvn clean verify
  - docker build -t $DOCKERHUB_USER/tp_database ./Database

jobs:
  include:
    - stage: build
      if: branch = develop
      script:
        - docker build -t $DOCKERHUB_USER/database_base ./Database
    - stage: publish
      if: branch = develop
      after_success:
        - echo $DOCKERHUB_PWD | docker login --username $DOCKERHUB_USER --password-stdin
        - docker tag $DOCKERHUB_USER/database_base $DOCKERHUB_USER/database_base:1.1
        - docker push $DOCKERHUB_USER/database_base
